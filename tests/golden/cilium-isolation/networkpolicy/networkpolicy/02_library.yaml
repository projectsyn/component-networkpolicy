apiVersion: espejote.io/v1alpha1
kind: JsonnetLibrary
metadata:
  labels:
    app.kubernetes.io/name: espejote-networkpolicy-sync
  name: espejote-networkpolicy-sync
  namespace: syn-espejote
spec:
  data:
    config.json: |-
      {
          "hasCilium": true,
          "ignoredNamespaces": [
              "my-ignored-namespace"
          ],
          "namespaceLabels": {
              "baseDefaults": "network-policies.syn.tools/base-defaults",
              "noDefaults": "network-policies.syn.tools/no-defaults",
              "policySetPrefix": "set.network-policies.syn.tools/"
          },
          "netpolAnnotations": {
              "syn.tools/source": "https://github.com/projectsyn/component-networkpolicy.git"
          },
          "netpolLabels": {
              "app.kubernetes.io/component": "networkpolicy",
              "app.kubernetes.io/managed-by": "espejote",
              "app.kubernetes.io/part-of": "syn"
          },
          "policies": {
              "cilium/syn-internal-set-base": {
                  "endpointSelector": {

                  },
                  "ingress": [
                      {
                          "fromEntities": [
                              "host"
                          ]
                      },
                      {
                          "fromNodes": [
                              {
                                  "matchLabels": {
                                      "syn.tools/cluster-id": "c-green-test-1234"
                                  }
                              }
                          ]
                      }
                  ]
              },
              "syn-internal-set-base": {
                  "ingress": [
                      {
                          "from": [
                              {
                                  "namespaceSelector": {
                                      "matchLabels": {
                                          "test.example.net/test-group": "main"
                                      }
                                  }
                              }
                          ]
                      }
                  ],
                  "podSelector": {

                  },
                  "policyTypes": [
                      "Ingress"
                  ]
              },
              "syn-set-default-allow-intra-namespace": {
                  "ingress": [
                      {
                          "from": [
                              {
                                  "podSelector": {
                                      "matchLabels": {
                                          "io.cilium.k8s.policy.cluster": "c-green-test-1234"
                                      }
                                  }
                              }
                          ]
                      }
                  ],
                  "podSelector": {

                  },
                  "policyTypes": [
                      "Ingress"
                  ]
              }
          },
          "policySets": {
              "base": [
                  "cilium/syn-internal-set-base",
                  "syn-internal-set-base"
              ],
              "default": [
                  "syn-set-default-allow-intra-namespace"
              ]
          }
      }
